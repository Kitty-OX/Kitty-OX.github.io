---

---
---

# The Story

![Task banner for day DAY 1](https://tryhackme-images.s3.amazonaws.com/user-uploads/5fc2847e1bbebc03aa89fbf2/room-content/5fc2847e1bbebc03aa89fbf2-1730193392309.svg)

_McSkidy tapped keys with a confident grin,_

_A suspicious website, now where to begin?_

_She'd seen sites like this, full of code and of grime,_

_Shady domains, and breadcrumbs easy to find._

---

ูู ุนุงู ูุงูุชู ุจุฎูุฑ ููุงูู 2024 ูุฑุจุช ูุจุฏุฃ Advent of Cyber 2024 ุฒู ูู ุณูู.
ูู ุงูููู ุงูุงูู ููุชุนูู ุงุฒุงู ูุญูู ูู ูููุงุช ุงูุฑูุงุจุท ุงูุถุงุฑุฉ (Malicious Link Files) .. ูููุงู ููููู ุฅูู ูู OPSEC ูุฃูููุชูุ
ูููุชุนูู ุชุชุจุน ุงููููุงุช ุงูุฑูููุฉ ูุฑุจุทูุง ุจุฃุดุฎุงุต ุญูููููู ... ุฎูููุง ูููู ุงูุณููุงุฑูู ุงูุงูู ุนู ุงูู ูุงูู ูุทููุจ ูููุง ูุนููู

ุงููููุน ุงููู ุจูุญูู ููู ุงุณูู **"The Glitch's All-in-One Converter"** ูู ุฃุฏุงุฉ ูุชุญููู ููุฏูููุงุช YouTube ุฅูู ูููุงุช MP3ุ ูุจูุชู ุชุฏุงููู ุจูู ููุธูู SOC-mas ุงููููุน ุดููู ูู ุงูุจุฏุงูุฉ ุดุฑุนู ูุฌุฐุงุจ ููู ุตูุญุฉ "About" ุจุชููู ุฅู ุงููููุน ูุนููู ุจูุงุณุทุฉ "The Glitch"
ูููุงูู ูู ุงููููุน ุจุฑุถู ุจูููู ุฅู ุฎุฏูุงุชู "ุขููุฉ" ู"ูุญููุฉ"ุ ููู ูู ุฎุจุฑุชูุง ุฏู ุบุงูุจูุง ูุฌุฑุฏ ููุงู ุชุณูููู ููุด ุตุญูุญ ๐ค
**ุทูุจ ููู ุจูููู ุงูู ูุด ุขูู ุงู ุงูู ูู ุงูุชูุฏูุฏุงุช ุงููุญุชููู ูู ุงููููุน ุฏุงุ**

>[!bug] Malvertising (ุงูุฅุนูุงูุงุช ุงูุถุงุฑุฉ):
> ูุชูุฑ ูู ุงูููุงูุน ุฏู ุจุชุนุฑุถ ุฅุนูุงูุงุช ุฎุจูุซุฉ ุงูุฅุนูุงูุงุช ุฏู ูููู ุชุณุชุบู ุซุบุฑุงุช ูู ุฃุฌูุฒุฉ ุงููุณุชุฎุฏูุ ูุชูุตู ุจุฑูุฌูุงุช ุฎุจูุซุฉ.
>- ูุซุงู: ุธููุฑ ููุงูุฐ ููุจุซูุฉ (Pop-ups) ูุฒุนุฌุฉ ุชุทูุจ ุชุญููู ุชุญุฏูุซุงุช ูุฒููุฉ.

>[!bug] Phishing Scams (ุงุญุชูุงู ุงูุชุตูุฏ ุงูุฅููุชุฑููู)
>ูููู ูุทูุจ ููู ุงููููุน ููุก ุงุณุชุจูุงูุงุช ุฃู ุชูุฏูู ุจูุงูุงุช ุดุฎุตูุฉ ุจุญุฌุฉ ุชูุฏูู ุงูุฎุฏูุฉ ูุงูุจูุงูุงุช ุฏู ูููู ุชูุณุชุฎุฏู ูู ูุฌูุงุช ุงุญุชูุงู ูุงุญูุฉ.

>[!bug] Bundled Malware (ุงูุจุฑูุฌูุงุช ุงูุถุงุฑุฉ ุงููุฑููุฉ)
>ุฃุญูุงููุง ุงููููุงุช ุงููุญููุฉ ูู ุงููููุน ุจูููู ูููุง ุจุฑูุฌูุงุช ุฎุจูุซุฉ ุจุงูุชุงูู ุงููุณุชุฎุฏู ูููู ูุซุจุช ุจุฑุงูุฌ ุถุงุฑุฉ ุนูู ุฌูุงุฒู ุจุฏูู ูุง ูุงุฎุฏ ุจุงููุ ุฒู ุฃุฏูุงุช Keyloggers ุฃู Trojans ูุฏุง ุงููู ููุญุตู ูุนุงูุง ุงููุงุฑุฏู

---
ุทุจุนุง Tryhackme ูุถุญ ุจุงููุนู ุงุฒุงู ูุจุฏุฃ ูุญูู ูู ุงููููุน ูุงูุงุฏูุช ุงููู ููุณุชุฎุฏููุง ูุงูุฎุทูุงุช ุงูุงูู ุงููู ุนูู ุงุณุงุณูุง ููุจุฏุฃ ูุญู ุจุงูู ุงูุงุณุฆูู ูุฃูุง ูุงุฎุชุตุฑ ูุงุนูู ูุจุฐู ุชูุถูุญูู ุนู ุงูุฎุทูุงุช ูุงูุงุฏูุงุช ุงููู ุชู ุชูุถูุญูุง ูู ุงูุฑูู ูููุงู ุงูุถุญ ุงููุชุงุฆุฌ ุงููู ูุตููุง ููุง ูุงูุฎุทูุฑุฉ ุจุชุงุนุชูุง

### Investigation Steps 

>[!quote] ุฎุทูุงุช ุงูุชุญููู 
>ูู ุงูุจุฏุงูู ููุดุบู ุงููุงุดูู ุนุดุงู ููุชุญ ุงููููุน ุฒู ูุงูู ููุถุญ ูู ุงูุฑูู ููุฎูู ุจุงููุง ุงููุง ููุนููุด Download ุงู ููุชุญ ุญุงุฌู ุนูู ูุธุงููุง ุงูุงุณุงุณู
>ุจุนุฏ ูุฏุง ูู ุงูุฎุทูุงุช ุงููู ููุฌูุฏุฉ ูู ุงูุฑูู ูู ุงููุง ูุฌุฑุจ ูุญูู ููุฏูู ููุนููู download ุงููู ุจููุฒู ูููู zip ุซู ูุนููู **Extract** 
>ููุธูุฑููุง ููู ุงุณูู song.mp3 ูููู ุชุงูู ุงุณูู somg.mp3 ููู ุชุญููููุง ููููู ุงูุงูู ุทูุน ุงู ูููุด ุญุงุฌู suspicious
>ููู ุงูููู ุงูุชุงูู ูู ุงููู ุถุงุฑ ๏ปทู ุจุฏู ูุง ูููู ุงูููู MP3ุ ุทูุน "MS Windows shortcut" ุฃู ุงููุนุฑูู ุจููู `**.lnk**`

#### ุฅูู ูู ููู .lnkุ

>ูููุงุช `.lnk` ูู ุงุฎุชุตุงุฑุงุช ูู ูุธุงู ุชุดุบูู ูููุฏูุฒ. ุจุชูุณุชุฎุฏู ูุฑุจุท ูููุ ูุฌูุฏุ ุฃู ุจุฑูุงูุฌ ูุนูู ุนูู ุณุทุญ ุงูููุชุจ ูุซููุงุ ุงูุงุฎุชุตุงุฑุงุช ุงููู ุจุชูุชุญ ุงูุจุฑุงูุฌ ุฒู ุงููุชุตูุญ ุฃู ุงูุฃูุนุงุจ ูู ูููุงุช .lnk
>**ุทูุจ ูุงุถุญ ุงูู ุจุฑูุงูุฌ ุนุงุฏู ููู ูููุง ุงูู ุถุงุฑุ**
>๏ปทู ุงูู Attackers ูููู ูุณุชุบููุง ุงูููุน ุฏู ูู ุงููููุงุช ูุชุดุบูู Commands ูุจุงุดุฑุฉ ุนูู ุฌูุงุฒู ุจุฏู ูุง ุงูููู ูุฑุจุทู ุจุฃุบููุฉ MP3ุ ูููู ูุดุบู ุณูุฑูุจุช ุฎุจูุซ ุฃู ูุดุบู ุจุฑูุฌูุฉ ุถุงุฑุฉ ูู ุงูุฎูููุฉ ุฒู ุงูู Powershell script ุงููู ูุตููุง ูู ูุน tryhackme

---
ุทูุจ ุชูุงู ูุฏุง ุงุญูุง ุนุฑููุง ุงู ุงูููู ุฎุทูุฑ ูุนุฑููุง ุงูุณุจุจ ุจุนุฏุง ูุง ุงุณุชุฎุฏููุง 2 tools ูุน THM ููููู ูุณุชุฎุฏู ุงุฏูุงุช ุชุงููู ุจุฑุถู ุฒู Virustotal:

ุจูุนูู upload ููููู ุงู ุจูุงุฎุฏ ุงููุงุด ุจุงุณุชุฎุฏุงู ุงููููุงูุฏ ุฏุง:


![[md5.png]]

ูุจุนุฏูู ููุญุตู ุจุงุณุชุฎุฏุงู Virustotal

![[Cyber Advent/assets/Selection_060.png]]

![[Cyber Advent/assets/Selection_061.png]]

ุฎูููุง ููุถุญ ุงูุงุฏูุงุช ูุงูุงูุงูุฑ ุงููู ุงุณุชุฎุฏููุงูุง ูู ุงูุชุญููู:****

|**Tool/Command**|**Purpose**|**How to Use**|**Output**|
|---|---|---|---|
|**Command `file`**|- Identify the file type.|`file <filename>`|- Displays the file type, e.g., "MS Windows shortcut", "PNG image".|
|**Tool `exiftool`**|- Extract metadata from files.|`exiftool <filename>`|- Shows details like author name, creation date, and file properties.|
|**VirusTotal**|- Analyze files or URLs for malware or suspicious activity.|- Upload the file on VirusTotal website or use the API for scanning.|- Provides a detailed report: malicious or safe, hash info, and file behavior.|

---
### PowerShellยscript

**ุงุญูุง ููุง ุงุณุชุฎุฏููุง exiftool ุธูุฑ ููุง powershell command ูุชูุงุตููุฉ ูุงูุช:**

![[exif 1.png]]

#### 1. ุงูู Flags `-ep Bypass` ู `-nop`:

ุงูุฃุนูุงู ุฏู (Flags) ุจุชุชุถุงู ูุฃูุงูุฑ PowerShell ุนุดุงู ุชูุบู ุงููููุฏ ุงูุนุงุฏูุฉ ุงููู ุจุชููุน ุชุดุบูู ุณูุฑูุจุชุงุช ุบูุฑ ููุซููุฉ
ุงูู`-ep Bypass`: ุจุชูุบู ุงูู "Execution Policy" ุงููู ุจุชุญุฏุฏ ููุน ุงูุณูุฑูุจุชุงุช ุงููุณููุญ ุจุชุดุบูููุง
ุงูู`-nop`: ุจุชุดุบู PowerShell ูู ุบูุฑ ูุง ุชุญููู ุฅุนุฏุงุฏุงุช ุงูู User Profile (ุงูุฅุนุฏุงุฏุงุช ุงูุดุฎุตูุฉ ูููุณุชุฎุฏู) ุจูุนูู ุจุณูุทุ ุจุชูุชุญ ุงูุจุงุจ ูุชุดุบูู ุงูุณูุฑูุจุชุงุช ุจุญุฑูุฉ ูู ุบูุฑ ุฃู ุนูุจุงุช ุฃูููุฉ.

#### 2. ุงุณุชุฎุฏุงู `DownloadFile`:

ุงูููุฏ ุจูุณุชุฎุฏู Method (ุทุฑููุฉ) ุงุณููุง `DownloadFile` ุนุดุงู ูุญูู ููู (ูู ุงูุญุงูุฉ ุฏู ุงุณูู IS.ps1) ูู ุณูุฑูุฑ ุจุนูุฏ ูุนููุงู ุงูููู: `https://raw.githubusercontent.com/MM-WarevilleTHM/IS/refs/heads/main/IS.ps1`  ูุจุนุฏ ุงูุชูุฒูู ุจูุชุญุท ูู ูููุฏุฑ: **`C:\ProgramData\`**

#### 3. ุชุดุบูู ุงูุณูุฑูุจุช ุจุงุณุชุฎุฏุงู `iex`:

ุจุนุฏ ูุง ุงูููู ูุชุญูู ุนูู ุงูุฌูุงุฒุ ุจูุชููุฐ ุจุงุณุชุฎุฏุงู ุฃูุฑ `iex` ุงููู ูู ุงุฎุชุตุงุฑ ูู **Invoke-Expression**.
ุงูุฃูุฑ ุฏู ุจูุดุบูู ุงูุณูุฑูุจุช ุงููู ุชู ุชุญูููู (`IS.ps1`) ุจุงุณุชุฎุฏุงู PowerShell ูุงููุชูุฌุฉ ูู ุงู ุงูููุฏ ุงูุถุงุฑ ุงูููุฌูุฏ ูู ุงูุณูุฑูุจุช ูุจุฏุฃ ูุดุชุบู ุนูู ุงูุฌูุงุฒ

---
## Introduction toยOPSEC

#### ูุนูู ุฅูู OPSECุ

- ุงูู **OPSEC** ูู ุงุฎุชุตุงุฑ ูู **Operational Security**ุ ูุฏู ููููู ุฃุตูู ุนุณูุฑู ูุนูุงู ุญูุงูุฉ ุงููุนูููุงุช ุงูุญุณุงุณุฉ ูุงูุนูููุงุช ูู ุงููููุน ูู ุฅูุฏูู ุงูุฎุตูู
- ุงููุฏู ููู ุฅูู ุชูุชุดู ูุชูุบู ุฃู ุซุบุฑุงุช ูููู ุงูููุงุฌู ูุณุชุบููุง ุนุดุงู ูุนุฑู ูููุชู ุฃู ุฎุทุทู

---

#### **ุฅูู ุงููู ุจูุญุตู ูู ููู ูุดู ูู OPSECุ**

ูู ุนุงูู ุงูุฃูู ุงูุณูุจุฑุงููุ ููุง ุงูููุงุฌููู ูุง ูุชุจุนูุด ููุงุฑุณุงุช OPSEC ุจุดูู ุตุญูุญุ ูููู ูุณูุจูุง ุขุซุงุฑ ุฑูููุฉ ูุฑุงูู ูุงูุขุซุงุฑ ุฏู ูู ุชู ุฌูุนูุง ุจุฐูุงุกุ ูููู ุชูุดู ุนู ูููุชูู ๐ฌ

---

#### **ุฃุฎุทุงุก ุดุงุฆุนุฉ ูู OPSEC:**

1. **ุฅุนุงุฏุฉ ุงุณุชุฎุฏุงู ุฃุณูุงุก ุงูุญุณุงุจุงุช ุฃู ุงูุฅููููุงุช**:
    
    - ูู ุงูููุงุฌู ุงุณุชุฎุฏู ููุณ ุงูุงุณู ุฃู ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ุนูู ุฃูุชุฑ ูู ููุตุฉุ ุฏู ุจูุณููู ุชุชุจุนู.
    - ุฃุญูุงููุง ุจูููู ุงูุณุจุจ ุบุฑูุฑ ุฃู ูุณูุงูุ ููู ุงููุชูุฌุฉ ูุงุญุฏุฉ: ูุดู ุงููููุฉ.
2. **ุงุณุชุฎุฏุงู Metadata ูููู ุชุนูุจู**:
    
    - ุฒู ุจูุงูุงุช ูุฎููุฉ ูู ุงูุตูุฑ ุฃู ุงูููุฏ (Metadata) ุงููู ุชูุดู:
        - ุงุณู ุงูุฌูุงุฒ.
        - ุฅุญุฏุงุซูุงุช GPS.
        - ุงูููุช ูุงูุชุงุฑูุฎ.
3. **ูุดุฑ ูุนูููุงุช ุจุดูู ุนููู**:
    - ุงููุชุงุจุฉ ูู ููุชุฏูุงุช ุฃู ุฑูุน ุฃููุงุฏ ุนูู GitHub ูุน ุชูุงุตูู ูููู ุชุชุฑุจุท ุจูููุชูู ุฃู ููุงููู
4. **ุนุฏู ุงุณุชุฎุฏุงู VPN ุฃู Proxy ุฃุซูุงุก ุงููุดุงุทุงุช ุงูุฎุจูุซุฉ**:
    
    - ุฏู ูุณูุญ ููุฌูุงุช ุงูุฃูููุฉ ุจุชุชุจุน ุนููุงู ุงูู IP ุงูุญูููู ููุดุฎุต.

>**ุนูุฏูุง ุงูุซุจู ุญููููุฉ ุนู OPSECยmistakes ุชู ุฐูุฑูุง ูู ุงูุฑูู**

---
## Questions:

##### 1. Looks like the song.mp3 file is not what we expected! Run "exiftool song.mp3" in your terminal to find out the author of the song. Who is the author?

![[Screenshot_2024-12-13_09-44-04.png]]

##### 2. The malicious PowerShell script sends stolen info to a C2 server. What is the URL of this C2 server?

>ูููุงูู ุงูุงุฌุงุจู ููุง https://raw.githubusercontent.com/MM-WarevilleTHM/IS/refs/heads/main/IS.ps1

##### 3. Who is M.M? Maybe his Github profile page would provide clues?
ูููุชุญ ุงูููุช github ุจุชุงุนู ููููุงูู ุงูุงุณู

![[Cyber Advent/assets/Selection_009.png]]

##### 4. What is the number of commits on the GitHub repo where the issue was raised?

![[Screenshot_2024-12-13_09-44-04 1.png]]